---
title: "Video Game Sales Analysis"
author: "Hariprabhaa Murugesan"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

The video games industry is worth billions of dollars, with companies spending vast amounts of money on the development and marketing of these games to an equally large market. It grows ever larger each year bringing new blockbuster hits. But all have achieved tens or even hundreds of millions in sales, and are unlikely to be unseated any time in the near future.Nintendo has made a lot of money by turning the Switch into a platform for independent developers, while Microsoft is pivoting to games as a service and Sony is continuing to move forward with an impressive line-up of exclusive titles.


# Problem Identification

Looking for the best-selling games of all time, itâ€™s a mix of classics and current-generation staples. Some have stood the test of time, others very much seem to be products of their era. Through analysis of factors like most popular Genre, Platform with more number of games, country that contributes more to the sales , valuable insights can be drawn which helps in the development of video games industry and sales can be increased.


# Load the required Packages

```{r}
library(tidyverse)
library(ggplot2)
```


# Data Introduction

Dataset analyzed was generated by a scrape of vgchartz.com and contains a list of video games with sales greater than 100,000 copies from the Year 1980 to 2016.

Fields include:

Rank - Ranking of overall sales

Name - The games name

Platform - Platform of the games release (i.e. PC,PS4, etc.)

Year - Year of the game's release

Genre - Genre of the game

Publisher - Publisher of the game

NA_Sales - Sales in North America (in millions)

EU_Sales - Sales in Europe (in millions)

JP_Sales - Sales in Japan (in millions)

Other_Sales - Sales in the rest of the world (in millions)

Global_Sales - Total worldwide sales.


# Load the data

```{r}
vg<-read.csv(file = "C:/Users/omkum/Downloads/vgsales.csv ",header = TRUE,stringsAsFactors = FALSE)
```


# Data Cleaning

Before analysing the data, it needs to be cleaned. Nearly 300 NULL value records are removed from the dataset and Year is converted from character to numeric.

```{r}
vg$Year<-suppressWarnings(as.numeric(vg$Year)) # convert character to numeric
vg<- na.omit(vg)
```

# Data Overview

Top 5 records in the dataset

```{r}
head(vg)
```

Last 5 records in the dataset

```{r}
tail(vg)
```

Structure of the dataset

```{r}
str(vg)
```

Dimensions of the dataset

```{r}
dim(vg)
```

Dataset Summary

```{r}
summary(vg)
```

Column Names in the datset

```{r}
colnames(vg)
```

# Global Sales over the years

As we can see the video game sales was at its peak around 2005 and it went on decreasing over the course of years.

```{r}
ggplot(vg,aes(x=Year,y =Global_Sales)) +geom_line(color="aquamarine3")
```

# Analysis by Genre

The below bar graph depicts the number of games in each genre. Action genre contains more number of games followed by Sports, Role-playing and puzzle has the least count. 

Count values are

```{r}
vg %>% 
  group_by(Genre) %>% 
  count(Genre) %>% 
  arrange(desc(n))
```


```{r}
ggplot(data=vg, aes(x=Genre)) +
    geom_bar(stat="count", fill= "aquamarine3")+theme(axis.text.x = element_text(size=10, angle=90))+coord_flip()
```


Since most of the games belongs to Action, Sports and Misc Genre, stacked bar has been plotted for the Global Sales accross these genres each year. Action games were sold out in more numbers before 2015 and Sports genre is dominating later.

```{r}

vg %>% 
  filter((Genre=="Action" | Genre=="Sports" | Genre=="Misc") & Year> 2010 & Year<2017) %>%
  ggplot(aes(x=Year,y=Global_Sales,fill=Genre)) +geom_bar(stat = "identity" , position=position_dodge())+theme(axis.text.x =   element_text(size=10, angle=90))

```

# Analysis by platform

The below bar graph depicts the number of games in each Platform. Ds tops the table with 2,163 games followed by PS2, PS3.

Count values are

```{r}

vg %>% 
  group_by(Platform) %>% 
  count(Platform) %>% arrange(desc(n)) 
```


```{r}

ggplot(data=vg, aes(x=Platform)) +
    geom_bar(stat="count",fill="aquamarine3")+theme(axis.text.x = element_text(size=10, angle=90))
```

Boxplot indicates the distribution of sales based on platform.

```{r}
ggplot(vg,aes(x=Platform,y=Global_Sales))+geom_boxplot(fill="aquamarine3") + theme(axis.text.x = element_text(size=10, angle=90))
```

Sales by Platform each year has been shown in the below graph.

```{r}
ggplot(vg,aes(x=Year,y=Global_Sales,group=Platform, color=Platform)) +geom_line() 
```

# Region wise Sales Analysis

Analysing the maximum sales in each region, Wii Sports takes the lead position in both North America & Europe whereas Pokemon tops the list in Japan and Grand Theft in other countries.

```{r}
vg[which.max(vg$NA_Sales),2]
```

```{r}
vg[which.max(vg$EU_Sales),2]
```

```{r}
vg[which.max(vg$JP_Sales),2]
```

```{r}
vg[which.max(vg$Other_Sales),2]
```




Below table contains Region wise Sales each year. Japan have no video games sales till 1983 whereas North America has good sales over the years.

```{r}
vg %>% 
  group_by(Year) %>% 
  summarise_at(vars("JP_Sales","NA_Sales","EU_Sales","Other_Sales","Global_Sales"),sum)

```

# Analysis by Publisher

Publisher with maximum sales:

```{r}

x<-vg %>% 
  group_by(Publisher) %>% 
  summarise(sum(Global_Sales)) 

vg[which.max(x$`sum(Global_Sales)`),]

```


Top selling 20 games in the market and the corresponding publishers. As per the graph, most of the games belongs to Nintendo.

```{r}
vg  %>%
  arrange(desc(Global_Sales)) %>% 
  head(30)  %>%ggplot(aes(x=Name,y=Global_Sales,fill=Publisher)) +geom_bar(stat = "identity",colour="black") +theme(axis.text.x = element_text(size=10, angle=90))
```


Pie chart demonstrates the Global Sales among the top 4 popular Publishers.

```{r}
vg %>%
  filter(Publisher=="Nintendo" | Publisher=="Electronic Arts" | Publisher=="Take-Two Interactive" | Publisher=="Microsoft Game Studios") %>%
  ggplot(aes(x="", y=Global_Sales, fill=Publisher)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) +
  theme_void()
```


# Prediction of Global sales


On trying to found out the region that contributes more towards the global sales,correlation matrix is constructed. As per the coefficient, North America influences the most.

```{r}
cor(vg[sapply(vg, is.numeric)])
```


NOrmal Distribution for log(global sales).

```{r}
ggplot(vg, aes(log(Global_Sales))) + geom_density(fill="blue")
```

Split the data for training and testing.

```{r }
set.seed(1)
row.number <- sample(1:nrow(vg), 0.8*nrow(vg))
train = vg[row.number,]
test = vg[-row.number,]
dim(train)
dim(test)
```

Below information contains the summary of model constructed.

```{r}
model1 = lm(log(Global_Sales)~NA_Sales, data=train)
summary(model1)
```

Plot the model. 

```{r}
par(mfrow=c(2,2))
plot(model1)
```

On predicting the Global sales, actual and predicted values are as follows:

```{r}
globsalespredict <- predict(model1, test) 
actuals_preds <- data.frame(cbind(actuals=test$Global_Sales, predicteds=globsalespredict))
head(actuals_preds)
```



# Conclusion

Based on the analysis and plots of sales data, the following conclusions can be drawn:

- Sports genre is gaining more popularity in recent times and hence development of this type of games will increase the sales. But Japan shows more interest in role playing games. Interest towards Action genre games is decreasing day by day.
- Games published by Nintendo gets more attention. Still Sony, Electronic Arts Sustains some top position in Global sales.
- North America contributes more towards the Global Sales based on the Correlation matrix. Through increasing sales in this region, game industry might gain some profit. At the same time, marketing can be increased in rest of the regions.


